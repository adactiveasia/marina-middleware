(()=>{var e={59:e=>{e.exports={secret:"adsign-secret-key"}},214:e=>{e.exports={HOST:"localhost",USER:"adsign",PASS:"6k3d9gWEUkPULD35",PORT:27017,DB_NAME:"adsign"}},523:(e,t,s)=>{const n=s(59),i=s(524),a=i.user,o=(i.role,s(722)),r=s(773);t.signup=(e,t)=>{const s=new a({email:e.body.email,password:r.hashSync(e.body.password,8)});a.findOne({email:e.body.email}).exec(((e,n)=>{e?t.status(500).send({message:e}):n?t.send({error:1,message:"Email registered"}):s.save(((e,s)=>{e?t.status(500).send({message:e}):t.send({error:0,message:"User was registered successfully!"})}))}))},t.signin=(e,t)=>{a.findOne({email:e.body.email}).exec(((s,i)=>{if(s)return void t.status(500).send({message:s});if(!i)return t.status(404).send({message:"User Not found."});if(!r.compareSync(e.body.password,i.password))return t.status(401).send({error:1,message:"Invalid Password!"});const a=o.sign({id:i.id},n.secret,{expiresIn:86400});t.status(200).send({error:0,id:i._id,email:i.email,name:i.name,accessToken:a})}))}},766:(e,t,s)=>{s(747),s(622);const n=s(123),i="admin@peoplenprops.com";t.send=async(e,t,s)=>{const{email:n}=e.body;try{return sendMail(n),t.status(201).json({message:"Email sent successefully"})}catch(e){e.statusCode||(e.statusCode=500),s(e)}},t.sendMail=(e,t)=>{const s=n.createTransport({host:"smtp.gmail.com",port:465,secure:!0,auth:{type:"OAuth2",user:i,clientId:"911102631843-p59ks7iislk081e8nlghse4ed7803ccb.apps.googleusercontent.com",clientSecret:"oKPo_rSkH9s7qFE2uCZZLhfk",refreshToken:"1//04OdU_iX9yqaGCgYIARAAGAQSNwF-L9IrZxbGVVa4_TXYQTec5vSWaMQkVPNEkfsMxWAJxm1WSdI4kTyYN5g92SQbhNrJRpElZSI",accessToken:"ya29.a0AfH6SMDkt7EXAo3ytJKs7ddUVr7u1VnE6v7y7b7hLZ22B0-5psRY1o_6qO_xBleCLvDZO3F2nEUVrbQp3qdUYJBQwNG4-6BpEcd0ibVTITd73rWPn02aLbJ3uV28YO0E_ZeJ5mBxX8-gFrDdxagzSzX-dBuQQLkZQ5Vgb8plEOY"}});s.verify();const a=e=>{let t="test";switch(e){case"1":t='\n            <h2 style="text-align: center;"><span style="font-weight: 400;">CONGRATULATIONS!&nbsp;</span></h2>\n            <h1 style="text-align: center;"><span style="font-weight: 400;">YOU HAVE WON</span></h1>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">5% OFF VOUCHER</span></h3>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">WITH NO MINIMUM SPEND*</span></h3>\n            <p style="text-align: center;">&nbsp;</p>\n            <img style="display: block; margin-left: auto; margin-right: auto; width: 50%;" src="cid:coupon@mac"/>\n            <p style="text-align: center;">&nbsp;</p>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">FLASH THIS EMAIL TO OUR ARTIST TO REDEEM!</span></h3>\n            <p style="text-align: center;"><span style="font-weight: 400;">*The voucher is only applicable for all regular priced items excluding mini M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C, VivaGlam and Accessories. This voucher cannot be used in conjunction with other in-store promotions. Valid till 31 December 2020. One-time use only. M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C Cosmetics Singapore reserve the rights to change these terms and conditions at any time without prior notice. M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C Cosmetics Singapore reserve the right of final decision in case of any disputes.</span></p>\n            ';break;case"2":t='\n            <h2 style="text-align: center;"><span style="font-weight: 400;">CONGRATULATIONS!&nbsp;</span></h2>\n            <h1 style="text-align: center;"><span style="font-weight: 400;">YOU HAVE WON</span></h1>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">$10 VOUCHER</span></h3>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">WITH NO MINIMUM SPEND*</span></h3>\n            <p style="text-align: center;">&nbsp;</p>\n            <img style="display: block; margin-left: auto; margin-right: auto; width: 50%;" src="cid:coupon@mac"/>\n            <p style="text-align: center;">&nbsp;</p>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">FLASH THIS EMAIL TO OUR ARTIST TO REDEEM!</span></h3>\n            <p style="text-align: center;"><span style="font-weight: 400;">*The voucher is only applicable for all regular priced items excluding mini M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C, VivaGlam and Accessories. This voucher cannot be used in conjunction with other in-store promotions. Valid till 31 December 2020. One-time use only. M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C Cosmetics Singapore reserve the rights to change these terms and conditions at any time without prior notice. M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C Cosmetics Singapore reserve the right of final decision in case of any disputes.</span></p>\n            ';break;case"3":t='\n            <h2 style="text-align: center;"><span style="font-weight: 400;">CONGRATULATIONS!&nbsp;</span></h2>\n            <h1 style="text-align: center;"><span style="font-weight: 400;">YOU HAVE WON</span></h1>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">FLUIDLINE BROW GEL CRÈME*</span></h3>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">FREE WITH EVERY PURCHASE</span></h3>\n            <p style="text-align: center;">&nbsp;</p>\n            <img style="display: block; margin-left: auto; margin-right: auto; width: 50%;" src="cid:coupon@mac"/>\n            <p style="text-align: center;">&nbsp;</p>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">FLASH THIS EMAIL TO OUR ARTIST TO REDEEM!</span></h3>\n            <p style="text-align: center;"><span style="font-weight: 400;">*The voucher is only applicable for all regular priced items excluding mini M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C, VivaGlam and Accessories. This voucher cannot be used in conjunction with other in-store promotions. Valid till 31 December 2020. One-time use only. M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C Cosmetics Singapore reserve the rights to change these terms and conditions at any time without prior notice. M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C Cosmetics Singapore reserve the right of final decision in case of any disputes.</span></p>\n            ';break;case"4":t='\n            <h2 style="text-align: center;"><span style="font-weight: 400;">CONGRATULATIONS!&nbsp;</span></h2>\n            <h1 style="text-align: center;"><span style="font-weight: 400;">YOU HAVE WON</span></h1>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">150S LARGE POWDER FACE BRUSH*</span></h3>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">FREE WITH EVERY PURCHASE</span></h3>\n            <p style="text-align: center;">&nbsp;</p>\n            <img style="display: block; margin-left: auto; margin-right: auto; width: 50%;" src="cid:coupon@mac"/>\n            <p style="text-align: center;">&nbsp;</p>\n            <h3 style="text-align: center;"><span style="font-weight: 400;">FLASH THIS EMAIL TO OUR ARTIST TO REDEEM!</span></h3>\n            <p style="text-align: center;"><span style="font-weight: 400;">*The voucher is only applicable for all regular priced items excluding mini M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C, VivaGlam and Accessories. This voucher cannot be used in conjunction with other in-store promotions. Valid till 31 December 2020. One-time use only. M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C Cosmetics Singapore reserve the rights to change these terms and conditions at any time without prior notice. M</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">A</span><span style="font-weight: 400;">∙</span><span style="font-weight: 400;">C Cosmetics Singapore reserve the right of final decision in case of any disputes.</span></p>\n            '}return t},o=e=>{let t="test";switch(e){case"1":t="5OFF.jpg";break;case"2":t="10OFF.jpg";break;case"3":t="BRUSH.jpg";break;case"4":t="CREME.jpg"}return t},r=e=>{let t="test";switch(e){case"1":t="./assets/5OFF.jpg";break;case"2":t="./assets/10OFF.jpg";break;case"3":t="./assets/BRUSH.jpg";break;case"4":t="./assets/CREME.jpg"}return t};return s.sendMail((t=>({from:i,to:e,subject:"YOU HAVE WON COUPON MAC",html:a(t),attachments:[{filename:o(t),path:r(t),cid:"coupon@mac"}]}))(t),((e,t)=>(t=e||t,e?(console.log(e),!1):(console.log("Message sent: "+t.response),!0)))),""}},802:(e,t,s)=>{s(747),s(622),s(54);const n=s(189),i=s(766);t.win=async(e,t,s)=>{const{win:a,email:o,mobile:r,first:l,last:p,birthday:c,optin:g}=e.body;try{const e=await n.find({email:o}).countDocuments(),s=await n.find({mobile:r}).countDocuments();if(e+s<5&&e<4&&s<4){const e=new n({email:o,mobile:r,first:l,last:p,birthday:c,optin:g});await e.save();let s="",h="";try{s=i.sendMail(o,a)}catch(e){h=e}return t.status(200).json({error:0,message:"user saved successefully",info:s,mailError:h})}return t.status(200).json({error:1,message:"you have claim more than 3 times"})}catch(e){e.statusCode||(e.statusCode=500),s(e)}}},524:(e,t,s)=>{const n=s(619);n.Promise=global.Promise;const i={};i.mongoose=n,i.user=s(189),i.role=s(190),i.ROLES=["user","admin","moderator"],e.exports=i},190:(e,t,s)=>{const n=s(619),i=n.model("Role",new n.Schema({name:String}));e.exports=i},189:(e,t,s)=>{const n=s(619),i=n.model("User",new n.Schema({username:String,email:String,password:String,name:String,createdAt:Number,organizationId:Number,organizationName:String}));e.exports=i},874:(e,t,s)=>{const n=s(127).Router(),{body:i}=s(756),a=s(523);n.post("/signup",[i("email").trim().isLength({min:5}),i("password").trim().isLength({min:8})],a.signup),n.post("/signin",[i("email").trim().isLength({min:5}),i("password").trim().isLength({min:8})],a.signin),e.exports=n},800:(e,t,s)=>{const n=s(127).Router(),{body:i}=s(756),a=s(802);n.post("/win",[i("win").trim(),i("email").trim().isLength({min:5}),i("mobile").trim().isLength({min:5}),i("first").trim().isLength({min:2}),i("last").trim().isLength({min:2}),i("birthday").trim().isLength({min:5}),i("optin").trim().isLength({min:3})],a.win),e.exports=n},983:e=>{"use strict";e.exports=require("@elastic/elasticsearch")},773:e=>{"use strict";e.exports=require("bcryptjs")},473:e=>{"use strict";e.exports=require("body-parser")},479:e=>{"use strict";e.exports=require("cors")},334:e=>{"use strict";e.exports=require("dotenv")},127:e=>{"use strict";e.exports=require("express")},756:e=>{"use strict";e.exports=require("express-validator")},54:e=>{"use strict";e.exports=require("firebase-admin")},747:e=>{"use strict";e.exports=require("fs")},722:e=>{"use strict";e.exports=require("jsonwebtoken")},619:e=>{"use strict";e.exports=require("mongoose")},633:e=>{"use strict";e.exports=require("multer")},123:e=>{"use strict";e.exports=require("nodemailer")},622:e=>{"use strict";e.exports=require("path")},231:e=>{"use strict";e.exports=require("uuid")}},t={};function s(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n](i,i.exports,s),i.exports}(()=>{s(334).config();const e=s(127),t=s(473),n=s(619),i=s(622),a=s(633),{v4:o}=s(231),r=s(479),{Client:l}=s(983),p=s(800),c=s(874),g=s(214),h=(new l({node:"http://localhost:9200"}),`mongodb+srv://${g.USER}:${g.PASS}@analytics-0.qcbmn.mongodb.net/${g.DB_NAME}?retryWrites=true&w=majority`),m=e(),y=a.diskStorage({destination:(e,t,s)=>{s(null,"images")},filename:(e,t,s)=>{s(null,o()+"-"+t.originalname)}});m.use(r()),m.use(t.json()),m.use(a({storage:y,fileFilter:(e,t,s)=>{"image/jpg"===t.mimetype||"image/png"===t.mimetype||"image/jpeg"===t.mimetype?s(null,!0):s(null,!1)}}).single("image")),m.use("/images",e.static(i.join(__dirname,"images"))),m.use(((e,t,s)=>{t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Methods","GET, POST, PUT, PATCH, DELETE"),s()})),m.use("/user",p),m.use("/auth",c),m.use(((e,t,s,n)=>{console.log(e);const i=e.statusCode||500,{message:a,data:o}=e;return s.status(i).json({message:a,data:o})})),n.connect(h,{useNewUrlParser:!0,useUnifiedTopology:!0}).then((e=>{m.listen("5000")})).catch((e=>console.log("ATLAS CONNECTION ERROR: ",e)))})()})();